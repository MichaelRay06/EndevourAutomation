"use strict";
/* IMPORT */
Object.defineProperty(exports, "__esModule", { value: true });
/* GET LOCK */
function getLock(id, timeout, options) {
    if (!id)
        return options.handlers.free(); // Free
    const release = options.locks.read[id];
    if (release) { // Override
        options.handlers.override(release());
    }
    else {
        const timeoutId = setTimeout(() => {
            delete options.locks.write[id];
            options.handlers.free();
        }, timeout);
        options.locks.write[id] = () => {
            clearTimeout(timeoutId);
            delete options.locks.write[id];
            return options.handlers.overridden();
        };
    }
}
/* EXPORT */
exports.default = getLock;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0X2xvY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvZ2V0X2xvY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLFlBQVk7O0FBSVosY0FBYztBQUVkLFNBQVMsT0FBTyxDQUFHLEVBQU0sRUFBRSxPQUFlLEVBQUUsT0FBb0I7SUFFOUQsSUFBSyxDQUFDLEVBQUU7UUFBRyxPQUFPLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFHLENBQUMsQ0FBQyxPQUFPO0lBRW5ELE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBRXZDLElBQUssT0FBTyxFQUFHLEVBQUUsV0FBVztRQUUxQixPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBRyxPQUFPLEVBQUcsQ0FBRSxDQUFDO0tBRTFDO1NBQU07UUFFTCxNQUFNLFNBQVMsR0FBRyxVQUFVLENBQUcsR0FBRyxFQUFFO1lBRWxDLE9BQU8sT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7WUFFL0IsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUcsQ0FBQztRQUUzQixDQUFDLEVBQUUsT0FBTyxDQUFFLENBQUM7UUFFYixPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUU7WUFFN0IsWUFBWSxDQUFHLFNBQVMsQ0FBRSxDQUFDO1lBRTNCLE9BQU8sT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7WUFFL0IsT0FBTyxPQUFPLENBQUMsUUFBUSxDQUFDLFVBQVUsRUFBRyxDQUFDO1FBRXhDLENBQUMsQ0FBQztLQUVIO0FBRUgsQ0FBQztBQUVELFlBQVk7QUFFWixrQkFBZSxPQUFPLENBQUMifQ==