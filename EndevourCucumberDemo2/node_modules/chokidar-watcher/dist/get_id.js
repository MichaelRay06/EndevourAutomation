"use strict";
/* IMPORT */
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
/* GET ID */
let isStatsReliable; // Under Windows we need stats objects using bigints https://github.com/nodejs/node/issues/12115
const statsCache = {}; //TODO: These values shouldn't be kept forever, or this could eventually become a memory leak
function getID(filePath, stats) {
    if (stats) {
        if (typeof isStatsReliable !== 'boolean')
            isStatsReliable = (process.platform !== 'win32') || typeof stats.ino === 'bigint';
        stats = isStatsReliable ? stats : statsCache[filePath];
    }
    else {
        stats = statsCache[filePath];
    }
    if (!stats) {
        try {
            stats = fs.statSync(filePath, { bigint: true }); // Without BigInts ino numbers are unreliable https://github.com/nodejs/node/issues/12115 //TSC
        }
        catch (_a) {
            return;
        }
    }
    statsCache[filePath] = stats;
    if (!stats.ino)
        return;
    return `${stats.ino}`;
}
/* EXPORT */
exports.default = getID;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0X2lkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2dldF9pZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsWUFBWTs7QUFFWix5QkFBeUI7QUFHekIsWUFBWTtBQUVaLElBQUksZUFBd0IsQ0FBQyxDQUFDLGdHQUFnRztBQUU5SCxNQUFNLFVBQVUsR0FBVSxFQUFFLENBQUMsQ0FBQyw2RkFBNkY7QUFFM0gsU0FBUyxLQUFLLENBQUcsUUFBZ0IsRUFBRSxLQUFnQjtJQUVqRCxJQUFLLEtBQUssRUFBRztRQUVYLElBQUssT0FBTyxlQUFlLEtBQUssU0FBUztZQUFHLGVBQWUsR0FBRyxDQUFFLE9BQU8sQ0FBQyxRQUFRLEtBQUssT0FBTyxDQUFFLElBQUksT0FBTyxLQUFLLENBQUMsR0FBRyxLQUFLLFFBQVEsQ0FBQztRQUVoSSxLQUFLLEdBQUcsZUFBZSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUV4RDtTQUFNO1FBRUwsS0FBSyxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUU5QjtJQUVELElBQUssQ0FBQyxLQUFLLEVBQUc7UUFFWixJQUFJO1lBRUYsS0FBSyxHQUFLLEVBQUUsQ0FBQyxRQUFpQixDQUFFLFFBQVEsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBYyxDQUFDLENBQUMsK0ZBQStGO1NBRTFLO1FBQUMsV0FBTTtZQUVOLE9BQU87U0FFUjtLQUVGO0lBRUQsVUFBVSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEtBQUssQ0FBQztJQUU3QixJQUFLLENBQUMsS0FBSyxDQUFDLEdBQUc7UUFBRyxPQUFPO0lBRXpCLE9BQU8sR0FBRyxLQUFLLENBQUMsR0FBRyxFQUFFLENBQUM7QUFFeEIsQ0FBQztBQUVELFlBQVk7QUFFWixrQkFBZSxLQUFLLENBQUMifQ==