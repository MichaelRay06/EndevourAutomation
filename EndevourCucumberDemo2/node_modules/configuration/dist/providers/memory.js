"use strict";
/* IMPORT */
Object.defineProperty(exports, "__esModule", { value: true });
const config_1 = require("../config");
const serializer_1 = require("../utils/serializer");
const type_1 = require("../utils/type");
const abstract_1 = require("./abstract");
/* MEMORY */
class ProviderMemory extends abstract_1.default {
    async read() {
        return this.readSync();
    }
    readSync() {
        const data = this.data || config_1.DEFAULTS.data, dataRaw = this.dataRaw || config_1.DEFAULTS.dataRaw;
        return { data, dataRaw };
    }
    async write(data, force = false) {
        return this.writeSync(data, force);
    }
    writeSync(data, force = false) {
        if (!force && this.isEqual(data))
            return;
        if (type_1.default.isString(data)) {
            this.data = serializer_1.default.deserialize(data);
            this.dataRaw = data;
            this.dataSchema = this.validate(this.data);
        }
        else {
            this.data = data;
            this.dataRaw = serializer_1.default.serialize(this.data, this.indentation);
            this.dataSchema = this.validate(this.data);
        }
        this.triggerChange();
    }
}
/* EXPORT */
exports.default = ProviderMemory;
