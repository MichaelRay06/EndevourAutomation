"use strict";
/* IMPORT */
Object.defineProperty(exports, "__esModule", { value: true });
const config_1 = require("../config");
const serializer_1 = require("../utils/serializer");
const memory_1 = require("./memory");
/* STORAGE */
class ProviderStorage extends memory_1.default {
    constructor(options) {
        var _a, _b;
        super(options);
        if (!options.storage)
            throw new Error('You need to pass a storage instance');
        this.id = (_b = (_a = options) === null || _a === void 0 ? void 0 : _a.id, (_b !== null && _b !== void 0 ? _b : config_1.DEFAULTS.id));
        this.storage = options.storage;
    }
    readSync() {
        const dataRaw = this.storage.getItem(this.id) || config_1.DEFAULTS.dataRaw, data = serializer_1.default.deserialize(dataRaw);
        return { data, dataRaw };
    }
    writeSync(data, force = false) {
        if (!force && this.isEqual(data))
            return;
        super.writeSync(data, true);
        this.storage.setItem(this.id, this.dataRaw);
    }
}
/* EXPORT */
exports.default = ProviderStorage;
