"use strict";
/* IMPORT */
Object.defineProperty(exports, "__esModule", { value: true });
const config_1 = require("../config");
const file_1 = require("../utils/file");
const serializer_1 = require("../utils/serializer");
const file_2 = require("./file");
/* JSON */
class ProviderJSON extends file_2.default {
    async read() {
        try {
            const dataRaw = await file_1.default.read(this.path, { encoding: 'utf8' }) || config_1.DEFAULTS.dataRaw, data = serializer_1.default.deserialize(dataRaw);
            return { data, dataRaw };
        }
        catch (_a) {
            const { data, dataRaw } = config_1.DEFAULTS;
            return { data, dataRaw };
        }
    }
    readSync() {
        try {
            const dataRaw = file_1.default.readSync(this.path, { encoding: 'utf8' }) || config_1.DEFAULTS.dataRaw, data = serializer_1.default.deserialize(dataRaw);
            return { data, dataRaw };
        }
        catch (_a) {
            const { data, dataRaw } = config_1.DEFAULTS;
            return { data, dataRaw };
        }
    }
    async write(data, force = false) {
        if (!force && this.isEqual(data))
            return;
        await super.write(data, true);
        file_1.default.write(this.path, this.dataRaw);
    }
    writeSync(data, force = false) {
        if (!force && this.isEqual(data))
            return;
        super.writeSync(data, true);
        file_1.default.writeSync(this.path, this.dataRaw);
    }
}
/* EXPORT */
exports.default = ProviderJSON;
